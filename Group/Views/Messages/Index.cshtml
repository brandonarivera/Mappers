
@{
    ViewData["Title"] = "Messaging";
}

<h1>Messaging</h1>

<div class="container">
    <ul id="messages">
    </ul>

    <input id="text" />

    <button id="send">
        Send Message
    </button>
</div>
@section Scripts{

    <script>
        //execute code every second
        setInterval(function () {
            //clear the list, get all messages, add messages to list

            $.ajax({
                url: '/api/MessageService',
                type: 'get'
            }).done(function (data) {
                $('#messages').html('');
                for (var i in data) {
                    $('#messages').append('<li>' + data[i].text + '</li>');
                }
            });
        }, 1000);

        //execute code when the button is clicked
        $('#send').click(function () {

            $.ajax({
                url: '/api/MessageService',
                type: 'post',
                data: JSON.stringify({ text: $('#text').val() }),
                contentType: "application/json"
            }).done(function () {
            });
        });

    </script>
}